# lwhhttpwss
<p>Lightweight, single threaded http and websockets server, completely written in C.</p>
<p>It does preallocate necessary resources for predetermined maximum number of connections.</p>
<p>Memory footprint stays pretty much the same over the time</p>

Static content is stored in &lt;binaryname&gt;.web.data and &lt;binaryname&gt;.web.index files in &lt;binarypath&gt;/data directory.</br>
<dl>
<dt> &lt;binarypath&gt;/data/&lt;binaryname&gt;.web.data 
<dd> Both compressed and uncompressed web content.
<dt> &lt;binarypath&gt;/data/&lt;binaryname&gt;.web.index
<dd> Simple, fast specialized btree index of content file names.
</dl>		
<dl>
<dt>To create or update these files mkcache service program must be used.
<dd>Server checks modification time of these files periodically.
<dd>If it is changed it loads them to memory, starts serving them and frees the last one seamlessly. 
<dd>This is the only condition malloc and free used after program start.
</dl>
<dl>
<dt>When you run mkcache
<dd>It scans all files in &lt;sourcepath&gt; matching extensions in &lt;mkcachepath&gt;/mime.types file.
	<dl>
	<dt>mime.types
	<dd>&lt;0|1&gt; 		&lt;mime type&gt;	&lt;extension&gt; ...
	<dl>
		<dd>0 : Do not compress
		<dd>1 : Compress
	</dl>
	</dl>
<dd>If file is marked for compression and compression gain is more than %40, stores both compressed and uncompressed content.
<dd>Otherwise it just stores uncompressed content.
<dd>Then generated temporary files are moved to &lt;cachepath&gt.
</dl>
<dl>
<dt>About command line parameters
<dd>Command line parameters are stored in a <binarypath>/conf/<binaryname>.cnf file.
<dd>Once program is run with no parameters given, default values are stored. If you supply a valig parameter it will be stored in this file.
<dd>It parses and stores valid program parameters.
<dd>It reads rest of the valid parameters from config file.
<dd>If no value of parameter is not stored in the config file, assigns hardcoded default value and stores.

<dt>Most common parameters
<dl>
<dt>-v	// Not stored
<dd>Prints version and build number (auto generated by version.h and time of build), and exits.
<dd>eg. 1.1.D20170513T011707
<dt>-a	// not stored
<dd>Prints app name (hardcoded internal application name) and exits
<dt>-va	// not stored
<dd>Prints app name and version and exits.
<dt>daemon=&lt;1|0&gt;	// stored
<dd>1 : Run as a daemon. Uses daemon(1, 0) library call.
<dd>In daemon mode all log messages are directed to syslog. So avoid dumping unnecessary messages, keep your log clean and meaningful.
</dl>
</dl>
More to come
		
